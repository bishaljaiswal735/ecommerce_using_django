{% extends 'base.html' %}
{% load static %}
{% load widget_tweaks %}
{% block content %}

<section class="section-content padding-y bg-light">
  <div class="container">

    <div class="row">
      <!-- Billing Form -->
      <aside class="col-lg-6 mb-4">
        <div class="card shadow-sm border-0">
          <div class="card-body">
            <h4 class="card-title mb-4 text-primary">Billing Address</h4>
            <form action="{% url 'order' %}" method="POST">
              {% csrf_token %}

              <div class="form-row">
                <div class="form-group col-md-6">
                  <label for="id_first_name" class="font-weight-bold">First Name</label>
                  {{ form.first_name|add_class:"form-control" }}
                </div>
                <div class="form-group col-md-6">
                  <label for="id_last_name" class="font-weight-bold">Last Name</label>
                  {{ form.last_name|add_class:"form-control" }}
                </div>
              </div>

              <div class="form-row">
                <div class="form-group col-md-6">
                  <label for="id_email" class="font-weight-bold">Email</label>
                  {{ form.email|add_class:"form-control" }}
                </div>
                <div class="form-group col-md-6">
                  <label for="id_phone" class="font-weight-bold">Phone Number</label>
                  {{ form.phone|add_class:"form-control" }}
                </div>
              </div>

              <div class="form-group">
                <label for="id_address_line_1" class="font-weight-bold">Address Line 1</label>
                {{ form.address_line_1|add_class:"form-control" }}
              </div>
              <div class="form-group">
                <label for="id_address_line_2" class="font-weight-bold">Address Line 2</label>
                {{ form.address_line_2|add_class:"form-control" }}
              </div>

              <div class="form-row">
                <div class="form-group col-md-6">
                  <label for="id_city" class="font-weight-bold">City</label>
                  {{ form.city|add_class:"form-control" }}
                </div>
                <div class="form-group col-md-6">
                  <label for="id_state" class="font-weight-bold">State</label>
                  {{ form.state|add_class:"form-control" }}
                </div>
              </div>

              <div class="form-group">
                <label for="id_country" class="font-weight-bold">Country</label>
                {{ form.country|add_class:"form-control" }}
              </div>

              <div class="form-group">
                <label for="id_order_note" class="font-weight-bold">Order Note</label>
                {{ form.order_note|add_class:"form-control" }}
              </div>
          </div>
        </div>
      </aside>

      <!-- Order Summary -->
      <aside class="col-lg-6 mb-4">
        <div class="card shadow-sm border-0">
          <div class="card-body">
            <h4 class="mb-4 text-primary">Your Order</h4>
            <table class="table table-bordered table-striped">
              <thead class="thead-light">
                <tr class="text-uppercase small">
                  <th scope="col">Product</th>
                  <th scope="col" width="120">Quantity</th>
                  <th scope="col" width="120">Price</th>
                </tr>
              </thead>
              <tbody>
                {% for cart_item in cartItem %}
                <tr>
                  <td>
                    <div class="d-flex align-items-center">
                      <img src="{{ cart_item.product.image.url }}" class="img-thumbnail mr-2" style="width: 50px; height: 50px;">
                      <div>
                        <a href="{{ cart_item.product.get_url }}" class="font-weight-bold text-dark">{{ cart_item.product.product_name }}</a>
                        <div class="text-muted small">
                          {% for item in cart_item.variation.all %}
                            {{ item.variation_category|capfirst }}: {{ item.variation_value|capfirst }}<br>
                          {% endfor %}
                        </div>
                      </div>
                    </div>
                  </td>
                  <td class="text-center">{{ cart_item.quantity }}</td>
                  <td>
                    <strong>Rs {{ cart_item.total_price }}</strong><br>
                    <small class="text-muted">Rs {{ cart_item.product.price }} each</small>
                  </td>
                </tr>
                {% endfor %}
              </tbody>
            </table>

            <button type="submit" name="submit" class="btn btn-primary btn-lg btn-block">
              Place Order
            </button>
            <a href="{% url 'store' %}" class="btn btn-outline-secondary btn-block">
              Continue Shopping
            </a>
            </form>
          </div>
        </div>
      </aside>
    </div>
  </div>
</section>

{% endblock %}
